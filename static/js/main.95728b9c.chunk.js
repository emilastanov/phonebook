(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{138:function(e,t,a){"use strict";a.r(t);a(70),a(95);var n=a(0),l=a.n(n),o=a(39),s=a.n(o),c=a(10),r=a.n(c),i=a(18),u=a(19),p=a(21),d=a(20),m=a(22),h=a(1),E=(a(117),a(24)),f=a.n(E),y="https://phonebook.pythonanywhere.com/",v=function(e,t){return f.a.get("https://phonebook.pythonanywhere.com/gc",{params:{from:e,to:t}})},A=function(e,t){var a=y+"gp/".concat(e,"/").concat(t);return f.a.get(a)},b=function(e,t,a,n){var l=y+"ap/".concat(e,"/").concat(t,"/").concat(a);return f.a.get(l,{params:{vk_id:n}})},g=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={data:null,inputValue:null,isLoading:!1,inputValueName:null},a.selectCode=function(){a.props.setActivePanel("select_code")},a.addPhoneNumber=function(){a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u041e\u043a",autoclose:!0,action:function(){a.state.inputValueName?b(a.props.data.country.code,a.state.inputValue,a.state.inputValueName).then(function(e){console.log(e.data)}):console.log("Number not added!"),a.setState({inputValueName:null}),a.getPhoneData()},style:"default"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041d\u043e\u043c\u0435\u0440."),l.a.createElement("p",null,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430:"),l.a.createElement(h.Div,null,l.a.createElement(h.Input,{placeholder:"\u0418\u043c\u044f",value:a.state.inputValueName,onChange:a.updateValueName}))))},a.updateValueName=function(e){a.setState({inputValueName:e.target.value})},a.getPhoneData=function(){if(a.setState({isLoading:!0,data:null}),a.state.inputValue)switch(a.props.data.country.code){case 7:10===a.state.inputValue.length?A(a.props.data.country.code,a.state.inputValue).then(function(e){"SUCCESS"===e.data.status?a.setState({data:e.data,isLoading:!1}):(a.setState({isLoading:!1}),a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u0414\u0430",autoclose:!0,action:a.addPhoneNumber,style:"default"},{title:"\u041d\u0435\u0442",autoclose:!0,style:"destructive"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430."),l.a.createElement("p",null,"\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d!",l.a.createElement("br",null),"\u0412\u044b \u0437\u043d\u0430\u0435\u0442\u0435 \u044d\u0442\u043e\u0442 \u043d\u043e\u043c\u0435\u0440?"))))}).catch(function(e){a.setState({isLoading:!1}),a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u0414\u0430",autoclose:!0,style:"default"},{title:"\u041d\u0435\u0442",autoclose:!0,style:"destructive"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430."),l.a.createElement("p",null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430!")))}):(a.setState({isLoading:!1}),a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u041e\u043a",autoclose:!0,style:"default"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430."),l.a.createElement("p",null,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u0433\u0438\u043e\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e!",l.a.createElement("br",null),"\u041f\u0440\u0438\u043c\u0435\u0440:",l.a.createElement("br",null),"9150000000",l.a.createElement("br",null),"4950000000"))));break;default:A(a.props.data.country.code,a.state.inputValue).then(function(e){"SUCCESS"===e.data.status?a.setState({data:e.data,isLoading:!1}):(a.setState({isLoading:!1}),a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u0414\u0430",autoclose:!0,action:a.addPhoneNumber,style:"default"},{title:"\u041d\u0435\u0442",autoclose:!0,style:"destructive"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430."),l.a.createElement("p",null,"\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d!",l.a.createElement("br",null),"\u0412\u044b \u0437\u043d\u0430\u0435\u0442\u0435 \u044d\u0442\u043e\u0442 \u043d\u043e\u043c\u0435\u0440?"))))}).catch(function(e){a.setState({isLoading:!1}),a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u0414\u0430",autoclose:!0,style:"default"},{title:"\u041d\u0435\u0442",autoclose:!0,style:"destructive"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430."),l.a.createElement("p",null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430!")))})}else a.setState({isLoading:!1}),a.props.setAlert(l.a.createElement(h.Alert,{actionsLayout:"horizontal",actions:[{title:"\u041e\u043a",autoclose:!0,style:"default"}],onClose:a.props.closeAlert},l.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430."),l.a.createElement("p",null,"\u041f\u043e\u043b\u0435 \u0432\u0432\u043e\u0434\u0430 \u043d\u043e\u043c\u0435\u0440\u0430 - \u043f\u0443\u0441\u0442\u043e.")))},a.updateValue=function(e){a.setState({inputValue:e.target.value})},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return l.a.createElement(h.Panel,{id:this.props.id},l.a.createElement(h.PanelHeader,null,"\u0422\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a"),l.a.createElement(h.Group,{title:"\u041f\u043e\u0438\u0441\u043a"},l.a.createElement(h.FormLayout,null,l.a.createElement(h.SelectMimicry,{top:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043e\u0434 \u0441\u0442\u0440\u0430\u043d\u044b",placeholder:"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u0430",onClick:this.selectCode},this.props.data.country.name?l.a.createElement("span",null," +",this.props.data.country.code," ",this.props.data.country.name," "):null),l.a.createElement(h.Input,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440",type:"tel",value:this.state.inputValue?this.state.inputValue:null,onChange:this.updateValue}),l.a.createElement(h.Button,{size:"xl",level:"1",onClick:this.getPhoneData},"\u041f\u043e\u0438\u0441\u043a"))),this.state.isLoading?l.a.createElement(h.Div,null,l.a.createElement(h.Spinner,{size:"medium",style:{marginTop:20}})):this.state.data?l.a.createElement(h.Group,{title:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442"},l.a.createElement(h.List,null,this.state.data.name.map(function(e,t){return l.a.createElement(h.Cell,{key:t},e)}))):null,l.a.createElement(h.Footer,null,"\u0412\u0432\u0435\u0434\u0438 \u043d\u043e\u043c\u0435\u0440 \u0438 \u043d\u0430\u0436\u043c\u0438 \u043f\u043e\u0438\u0441\u043a, \u0447\u0442\u043e\u0431\u044b \u0443\u0437\u043d\u0430\u0442\u044c \u0438\u043c\u044f \u0430\u0431\u043e\u043d\u0435\u043d\u0442\u0430."))}}]),t}(l.a.Component),S=a(68),C=a.n(S),k=a(40),V=a.n(k),L=Object(h.platform)(),w=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(l)))).state={list:null,from:0,to:20},a.updateList=function(){a.setState({from:a.state.to,to:a.state.to+20}),v(a.state.from,a.state.to).then(function(e){a.setState({list:a.state.list.concat(e.data)}),a.state.to<200&&window.addEventListener("scroll",a.onScroll,!1)}),window.removeEventListener("scroll",a.onScroll,!1)},a.onScroll=function(){a.state.list.length&&window.scrollY+window.innerHeight>=44*a.state.list.length-132&&a.updateList()},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;v(this.state.from,this.state.to).then(function(t){e.setState({list:t.data}),console.log(t.data)}),window.addEventListener("scroll",this.onScroll,!1)}},{key:"render",value:function(){var e=this;return l.a.createElement(h.Panel,{id:this.props.id},l.a.createElement(h.PanelHeader,{left:l.a.createElement(h.HeaderButton,{onClick:function(){return e.props.setActivePanel("home")}},L===h.IOS?l.a.createElement(C.a,null):l.a.createElement(V.a,null))},"\u0412\u044b\u0431\u043e\u0440 \u0441\u0442\u0440\u0430\u043d\u044b"),l.a.createElement(h.Group,null,this.state.list?l.a.createElement(h.List,null,this.state.list.map(function(t,a){return l.a.createElement(h.Cell,{key:a,onClick:function(){e.props.setCountry(t[0],t[1]),e.props.setActivePanel("home")}},"+",t[0]," ",t[1])})):l.a.createElement(h.Div,null,l.a.createElement(h.Spinner,{size:"medium",style:{marginTop:20}}))))}}]),t}(l.a.Component),P=(a(137),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).setActivePanel=function(e){a.setState({activePanel:e})},a.setCountry=function(e,t){a.setState({home:{country:{name:t,code:e}}})},a.setAlert=function(e){a.setState({alert:e})},a.closeAlert=function(){a.setState({alert:null})},a.state={activePanel:"home",user:null,home:{country:{name:"\u0420\u043e\u0441\u0441\u0438\u044f",code:7}},alert:null,access_token:null},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;r.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.setState({user:t.detail.data}),function(e){var t=y+"cu/".concat(e);return f.a.get(t)}(t.detail.data.id).then(function(e){"NOT_EXIST"===e.data.status?(console.log("NEW USER"),r.a.send("VKWebAppGetPhoneNumber")):console.log("OLD USER")});break;case"VKWebAppGetPhoneNumberResult":b(t.detail.data.phone_number.slice(0,1),t.detail.data.phone_number.slice(1),"".concat(e.state.user.first_name," ").concat(e.state.user.last_name),e.state.user.id).then(function(e){console.log("NEW USER >> "),console.log(e.data),r.a.send("VKWebAppGetAuthToken",{app_id:6888410,scope:"account,friends,wall"})});break;case"VKWebAppAccessTokenReceived":e.setState({access_token:t.detail.data.access_token}),r.a.send("VKWebAppCallAPIMethod",{method:"wall.post",params:{v:"5.92",access_token:e.state.access_token,message:"\u041f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u043d\u043e\u0432\u044b\u0439 \u0441\u0435\u0440\u0432\u0438\u0441 \u0432 \u0412\u041a!\ud83d\ude0e\n \u0417\u0434\u0435\u0441\u044c \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0443\u0437\u043d\u0430\u0442\u044c \u0438\u043c\u044f \u0442\u043e\u0433\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430,\u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e \u0437\u0432\u043e\u043d\u0438\u0442 \u0442\u0435\u0431\u0435 \u043f\u043e \u043d\u043e\u0447\u0430\u043c\ud83d\ude21,\n \u0438\u043b\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043d\u043e\u043c\u0435\u0440, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0442\u0435\u0431\u0435 \u0437\u0432\u043e\u043d\u0438\u043b/\u0430 \u0442\u0432\u043e\u0439 \u043f\u0430\u0440\u0435\u043d\u044c/\u0434\u0435\u0432\u0443\u0448\u043a\u0430\ud83e\udd2b,\n \u0438\u043b\u0438 \u043f\u0440\u043e\u0441\u0442\u043e \u0443\u0437\u043d\u0430\u0442\u044c \u0438\u043c\u044f \u0442\u043e\u0433\u043e, \u043a\u0442\u043e \u0442\u0435\u0431\u0435 \u0437\u0432\u043e\u043d\u0438\u043b,\u0430 \u0442\u044b \u043a\u0430\u043a \u0432\u0441\u0435\u0433\u0434\u0430 \u043d\u0435 \u0443\u0441\u043f\u0435\u043b \u043f\u043e\u0434\u043d\u044f\u0442\u044c \u0442\u0440\u0443\u0431\u043a\u0443\ud83d\ude22\n",attachments:"https://vk.com/app6888410"}});break;default:console.log(t.detail)}}),r.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){return l.a.createElement(h.View,{activePanel:this.state.activePanel,popout:this.state.alert},l.a.createElement(g,{id:"home",data:this.state.home,setActivePanel:this.setActivePanel,setAlert:this.setAlert,closeAlert:this.closeAlert}),l.a.createElement(w,{id:"select_code",setCountry:this.setCountry,setActivePanel:this.setActivePanel}))}}]),t}(l.a.Component));r.a.send("VKWebAppInit",{}),s.a.render(l.a.createElement(P,null),document.getElementById("root"))},69:function(e,t,a){e.exports=a(138)}},[[69,1,2]]]);
//# sourceMappingURL=main.95728b9c.chunk.js.map